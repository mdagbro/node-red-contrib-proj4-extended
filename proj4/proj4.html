<script type="text/javascript">
    RED.nodes.registerType('proj4',{
        category: 'geographic',
        color: '#a6bbcf',
        defaults: {
            name: {value:""},
            firstProjection: {value:"", required:true},
            secondProjection: {value:"", required:true},
        },
        inputs:1,
        outputs:1,
        icon: "white-globe.svg",
        label: function() {
            return this.name||"proj4";
        }
    });
</script>

<script type="text/x-red" data-template-name="proj4">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
        <div class="form-row">
        <label for="node-input-firstProjection" style="width:25%">Convert from</label>
        <select type="text" id="node-input-firstProjection" style="width:50%">
            <option value="EPSG:4326">WGS84 / GPS (EPSG:4326)</option>
            <option value="EPSG:27700">OSGB (EPSG:27700)</option>
            <option value="EPSG:2157">ITM (EPSG:2157)</option>
            <option value="EPSG:29903">Irish Grid (EPSG:29903)</option>
            <option value="EPSG:4269">NAD83 (EPSG:4269)</option>
            <option value="EPSG:3857">WGS84 / Psuedo-Mercator (EPSG:3857)</option>
        </select>&nbsp;(topics)
    </div>
    </div>
        <div class="form-row">
        <label for="node-input-secondProjection" style="width:25%">Convert to</label>
        <select type="text" id="node-input-secondProjection" style="width:50%">
            <option value="EPSG:27700">OSGB (EPSG:27700)</option>
            <option value="EPSG:2157">ITM (EPSG:2157)</option>
            <option value="EPSG:29903">Irish Grid (EPSG:29903)</option>
            <option value="EPSG:4269">NAD83 (EPSG:4269)</option>
            <option value="EPSG:4326">WGS84 / GPS (EPSG:4326)</option>
            <option value="EPSG:3857">WGS84 / Psuedo-Mercator (EPSG:3857)</option>
        </select>&nbsp;(topics)
    </div>
</script>

<script type="text/x-red" data-help-name="proj4">
    <p>The proj4 node converts coordinates from one <a href="https://en.wikipedia.org/wiki/Spatial_reference_system">geographic coordinate reference system to another</a>.</p>
    <p>The node outputs coordinates as an array of the form <code>[x,y]</code>.</p>
    <p>The user specifies a first coordinate reference system to 'Convert from' and a second to 'Convert to' from associated dropdown menus. When the node receives coordinate pairs in one of the specified formats, it will transform the values from the first coordinate system to the second, and return the results <code>payload.coords</code> as an array of the form <code>[x,y]</code>.</p>
    <p>As with proj4.js library, coordinates can be provided as an object of the form <code>{x:x,y:y}</code> or an array of the form <code>[x,y]</code>. Additionally the node will parse the message payload for coordinate pairs identified by the following keywords: 
    <ul>
        <li>x,y: <code>msg.payload.x && msg.payload.y</code></li>
        <li>lat,lon: <code>msg.payload.lon && msg.payload.lat</code></li>
        <li>latitude,longitude: <code>msg.payload.longitude && msg.payload.latitude</code></li>
        <li>eastings,northings: <code>msg.payload.eastings && msg.payload.northings</code></li>
    </ul></p>
    <p>Currently the Proj4 node supports the following coordinate systems:
    <ul>
        <li>OSGB (EPSG:27700)</li>
        <li>ITM (EPSG:2157)</li>
        <li>Irish Grid (EPSG:29903)</li>
        <li>NAD83 (EPSG:4269)</li>
        <li>WGS84 / GPS (EPSG:4326)</li>
        <li>WGS84 / Psuedo-Mercator (EPSG:3857)</li>
    </ul></p>
    <p>Further details of different coordinate reference systems can be found on <a href="https://epsg.io/">epsg.io</a>.</p>
    <p>If you are interested in suggesting enhancements please raise an issue for review via <a href="https://github.com/virtualarchitectures/node-red-contrib-proj4">GitHub</a>.</p>
</script>